<div class="d-flex justify-content-between align-items-center mb-4">
  <h2><i class="fas fa-list me-2"></i>Annonces</h2>
  <a routerLink="/dashboard/ads/create" class="btn btn-primary">
    <i class="fas fa-plus me-2"></i>Créer une annonce
  </a>
</div>

<!-- Filters -->
<div class="card mb-4">
  <div class="card-body">
    <div class="row">
      <div class="col-md-4">
        <label for="categoryFilter" class="form-label">Filtrer par catégorie</label>
        <select
          id="categoryFilter"
          class="form-select"
          [(ngModel)]="selectedCategoryId"
          (change)="onCategoryChange()">
          <option [ngValue]="null">Toutes les catégories</option>
          <option *ngFor="let category of categories" [ngValue]="category.id">
            {{ category.name }}
          </option>
        </select>
      </div>
    </div>
  </div>
</div>

<!-- Loading -->
<div *ngIf="loading" class="text-center my-5">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Chargement...</span>
  </div>
</div>

<!-- Error -->
<div *ngIf="error" class="alert alert-danger">
  {{ error }}
</div>

<!-- Ads List -->
<div *ngIf="!loading && !error" class="row">
  <div *ngFor="let ad of ads" class="col-md-6 col-lg-4 mb-4">
    <div class="card h-100 ad-card">
      <div class="card-img-top" style="height: 200px; overflow: hidden;">
        <img
          *ngIf="ad.images && ad.images.length > 0"
          [src]="ad.images[0]"
          [alt]="ad.title"
          class="w-100 h-100 object-fit-cover">
        <div *ngIf="!ad.images || ad.images.length === 0" class="w-100 h-100 bg-light d-flex align-items-center justify-content-center">
          <i class="fas fa-image fa-3x text-muted"></i>
        </div>
      </div>
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ ad.title }}</h5>
        <p class="card-text text-truncate">{{ ad.description }}</p>
        <div class="mt-auto">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="badge {{ getStatusBadgeClass(ad.status) }}">
              {{ getStatusText(ad.status) }}
            </span>
            <span class="h5 text-primary mb-0">{{ formatPrice(ad.price) }}</span>
          </div>

          <!-- Contact Info -->
          <div class="mb-2">
            <small class="text-muted d-block" *ngIf="ad.phone">
              <i class="fas fa-phone me-1"></i>{{ ad.phone }}
            </small>
            <small class="text-muted d-block" *ngIf="ad.address">
              <i class="fas fa-map-marker-alt me-1"></i>{{ ad.address }}
            </small>
          </div>

          <small class="text-muted">
            <i class="fas fa-tag me-1"></i>{{ ad.category.name }} •
            <i class="fas fa-user me-1"></i>{{ ad.user.name }}
          </small>

          <!-- Action Buttons -->
          <div class="d-flex gap-1 mt-2">
            <button class="btn btn-outline-primary btn-sm flex-fill" (click)="editAd(ad)">
              <i class="fas fa-edit me-1"></i>Modifier
            </button>
            <button class="btn btn-outline-danger btn-sm flex-fill" (click)="deleteAd(ad)">
              <i class="fas fa-trash me-1"></i>Supprimer
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Empty State -->
<div *ngIf="!loading && !error && ads.length === 0" class="text-center my-5">
  <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
  <h4>Aucune annonce trouvée</h4>
  <p class="text-muted">Il n'y a pas encore d'annonces dans cette catégorie.</p>
</div>

<!-- Pagination -->
<div *ngIf="!loading && !error && totalPages > 1" class="d-flex justify-content-center mt-4">
  <nav aria-label="Pagination">
    <ul class="pagination">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <a class="page-link" href="#" (click)="onPageChange(currentPage - 1); $event.preventDefault()">
          Précédent
        </a>
      </li>

      <li *ngFor="let page of getPagesArray()" class="page-item" [class.active]="page === currentPage">
        <a class="page-link" href="#" (click)="onPageChange(page); $event.preventDefault()">
          {{ page }}
        </a>
      </li>

      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <a class="page-link" href="#" (click)="onPageChange(currentPage + 1); $event.preventDefault()">
          Suivant
        </a>
      </li>
    </ul>
  </nav>
</div>

<!-- Stats -->
<div *ngIf="!loading && !error" class="mt-3 text-muted text-center">
  <small>{{ totalAds }} annonce(s) au total</small>
</div>
